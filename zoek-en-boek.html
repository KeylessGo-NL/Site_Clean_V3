<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8" />
    <title>Zoek &amp; boek een voertuig ‚Äì KeylessGo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Zoek en boek direct een keyless auto of busje van KeylessGo in de regio Utrecht. Filter op voertuigtype, locatie en gebruiksdoel en boek via SnappCar.">

    <!-- Leaflet CSS -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <!-- Eigen styles -->
    <link rel="stylesheet" href="data/styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Pagina-variant van de map-sectie */
        .map-section-page {
            padding-top: calc(var(--header-height) + 40px);
            padding-bottom: 70px;
        }

        .map-section-page h1 {
            font-size: 2.3rem;
            text-align: center;
            margin-bottom: 0.75rem;
        }

        .map-section-page .section-sub {
            margin-bottom: 1.6rem;
        }

        /* Meer-filters paneel */
        .advanced-filters {
            max-width: 1000px;
            margin: 0 auto 18px auto;
            background: #ffffff;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            padding: 10px 14px 12px;
            display: none;
        }

        .advanced-filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px 14px;
        }

        .advanced-filters .filter-group-inline label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 2px;
            color: var(--primary-blue);
        }

        .advanced-filters .filter-group-inline input,
        .advanced-filters .filter-group-inline select {
            width: 100%;
            padding: 7px 9px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-size: 0.85rem;
        }

        .advanced-filters .inline-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.82rem;
        }

        .advanced-filters-footer {
            margin-top: 8px;
            font-size: 0.76rem;
            color: #6b7280;
        }

        .map-advanced-toggle {
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .map-section-page {
                padding-top: calc(var(--header-height) + 20px);
            }

            .map-section-page h1 {
                font-size: 1.9rem;
            }

            .advanced-filters {
                padding: 10px 10px 12px;
            }
        }
    </style>
</head>
<body>

<header>
    <div class="container header-content">
        <a href="index.html" class="logo">
            <img src="img/partner/keylessgo-logo.jpg" alt="KeylessGo logo">
        </a>

        <nav class="nav-menu">
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="zoek-en-boek.html" class="active">Zoek &amp; Boek</a></li>

                <li class="has-submenu">
                    <a href="voertuigen.html">Voertuigen</a>
                    <ul class="submenu">
                        <li><a href="busje-huren.html">Busje huren</a></li>
                        <li><a href="auto-huren.html">Auto huren</a></li>
                        <li><a href="elektrisch-rijden.html">Elektrisch rijden</a></li>
                        <li><a href="onze-vloot.html">Onze vloot</a></li>
                    </ul>
                </li>

                <li><a href="tarieven.html">Tarieven</a></li>
                <li><a href="index.html#hoe-werkt-huren">Hoe het werkt</a></li>
                <li><a href="index.html#waarom-keylessgo">Waarom KeylessGo</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <a href="https://www.snappcar.nl" target="_blank" rel="noopener" class="btn btn-primary nav-cta">
                Direct huren via SnappCar.nl
            </a>
        </nav>

        <button class="hamburger" id="hamburger" aria-label="Menu openen" aria-expanded="false">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>
    </div>
</header>

<main>
    <!-- Map-sectie als pagina -->
    <section class="map-section map-section-page" id="zoek-en-boek">
        <div class="container">
            <h1>Zoek &amp; boek een voertuig in jouw buurt</h1>
            <p class="section-sub">
                Bekijk waar onze keyless busjes en auto‚Äôs staan in de regio Utrecht. 
                Vind snel een geschikt voertuig, navigeer erheen met Google Maps en boek direct via SnappCar.
            </p>

            <!-- BASISFILTERS BOVEN DE KAART -->
            <div class="map-filters">
                <input id="location-search" class="search-input" type="text" placeholder="Zoek op plaats, wijk of postcode (bijv. Utrecht, Houten, Amersfoort)">
                <select id="location-type-filter" class="type-select">
                    <option value="all">Alle voertuigtypen</option>
                    <option value="auto">Auto</option>
                    <option value="bus-small">Busje Small</option>
                    <option value="bus-medium">Busje Medium</option>
                    <option value="bus-large">Busje Large</option>
                    <option value="ev">Elektrisch</option>
                </select>
                <button id="location-search-btn" class="btn btn-secondary map-reset-btn">Zoek &amp; zoom</button>
                <button id="use-my-location" class="btn btn-secondary map-reset-btn">Gebruik mijn locatie</button>
                <button id="toggle-advanced-filters" class="btn btn-secondary map-reset-btn map-advanced-toggle">
                    Meer filters
                </button>
            </div>

            <!-- UITGEBREIDE FILTERS (UITKLAP) -->
            <div class="advanced-filters" id="advanced-filters">
                <div class="advanced-filters-grid">
                    <div class="filter-group-inline">
                        <label for="distance-filter">Afstand tot gekozen locatie</label>
                        <select id="distance-filter">
                            <option value="any">Geen limiet</option>
                            <option value="2">Binnen 2 km</option>
                            <option value="5">Binnen 5 km</option>
                            <option value="10">Binnen 10 km</option>
                        </select>
                    </div>

                    <div class="filter-group-inline">
                        <label for="usage-filter">Gebruik</label>
                        <select id="usage-filter">
                            <option value="all">Alles</option>
                            <option value="verhuizen">Verhuizen</option>
                            <option value="klussen">Klussen &amp; bezorgen</option>
                            <option value="weekend">Weekend weg</option>
                            <option value="zakelijk">Zakelijk gebruik</option>
                        </select>
                    </div>

                    <div class="filter-group-inline">
                        <label for="cargo-filter">Laadruimte (indicatief)</label>
                        <select id="cargo-filter">
                            <option value="all">Alle groottes</option>
                            <option value="compact">Compact (auto / Caddy)</option>
                            <option value="medium">Medium (Transporter)</option>
                            <option value="large">Large (Crafter)</option>
                        </select>
                    </div>

                    <div class="filter-group-inline">
                        <label>Budget (dagprijs)</label>
                        <div class="flex-gap">
                            <input type="number" id="price-min" placeholder="Min ‚Ç¨">
                            <input type="number" id="price-max" placeholder="Max ‚Ç¨">
                        </div>
                    </div>

                    <div class="filter-group-inline">
                        <label>Periode</label>
                        <div style="display:flex;gap:6px;">
                            <input type="date" id="date-from">
                            <input type="date" id="date-to">
                        </div>
                    </div>

                    <div class="filter-group-inline">
                        <label>Extra voorkeuren</label>
                        <div class="inline-checkbox">
                            <input type="checkbox" id="only-ev">
                            <label for="only-ev">Alleen elektrisch</label>
                        </div>
                        <div class="inline-checkbox">
                            <input type="checkbox" id="only-low-emission">
                            <label for="only-low-emission">Geschikt voor milieuzones</label>
                        </div>
                        <div class="inline-checkbox">
                            <input type="checkbox" id="only-keyless">
                            <label for="only-keyless">Alleen Keyless voertuigen</label>
                        </div>
                    </div>
                </div>
                <div class="advanced-filters-footer">
                    Deze extra filters zijn vooral handig voor planning, scenario‚Äôs en zakelijke users. 
                    Later kun je dit koppelen aan je eigen tools en beschikbaarheidsdata.
                </div>
            </div>

            <!-- LAYOUT MAP + RESULTATEN (zoals op index) -->
            <div class="location-layout">
                <div class="map-wrapper">
                    <div id="kg-map"></div>
                </div>

                <aside class="location-sidebar">
                    <h3>Dichtstbijzijnde voertuigen</h3>
                    <p class="location-sidebar-sub">
                        We tonen de voertuigen die het dichtst bij jouw gekozen locatie staan. 
                        Kies een voertuig om meer details te zien, op de kaart te tonen of direct via SnappCar te boeken.
                    </p>

                    <div class="results-panel-header" style="margin:0 0 6px 0;display:flex;justify-content:space-between;align-items:center;gap:8px;">
                        <span id="results-count" style="font-size:0.8rem;color:#6b7280;">
                            Voertuigen in de buurt van jouw zoeklocatie.
                        </span>
                        <div class="results-sort" style="font-size:0.78rem;">
                            <label for="sort-results">Sorteer op:</label>
                            <select id="sort-results" style="font-size:0.8rem;padding:3px 6px;">
                                <option value="distance">Afstand</option>
                                <option value="price-asc">Prijs (laag-hoog)</option>
                                <option value="price-desc">Prijs (hoog-laag)</option>
                                <option value="size">Grootte voertuig</option>
                            </select>
                        </div>
                    </div>

                    <div class="location-list" data-location-list></div>

                    <p class="location-note">
                        Alle reserveringen, betalingen en verzekering lopen via SnappCar. 
                        KeylessGo zorgt voor goed onderhouden voertuigen, slimme hotspots en support.
                    </p>
                </aside>
            </div>
        </div>
    </section>

    <!-- FAQ BLOK -->
    <section class="usp-blocks">
        <div class="container">
            <h2>Veelgestelde vragen over zoeken &amp; boeken</h2>
            <p class="section-sub">
                Korte antwoorden op veelgestelde vragen. Zo weet je precies waar je aan toe bent voordat je boekt.
            </p>

            <div class="usp-grid">
                <article class="usp-item">
                    <div class="usp-icon">üìç</div>
                    <h3>Hoe kies ik de beste locatie?</h3>
                    <p>
                        Zoek eerst op je woonplaats of wijk. Kies daarna een voertuig binnen 1‚Äì5 km zodat je er makkelijk naartoe kunt lopen of fietsen.
                    </p>
                </article>

                <article class="usp-item">
                    <div class="usp-icon">‚è±Ô∏è</div>
                    <h3>Kan ik last-minute boeken?</h3>
                    <p>
                        Ja, veel voertuigen zijn keyless en direct boekbaar. Vaak kun je binnen enkele minuten na je boeking al vertrekken.
                    </p>
                </article>

                <article class="usp-item">
                    <div class="usp-icon">üßæ</div>
                    <h3>Hoe werkt de prijsopbouw?</h3>
                    <p>
                        De basisprijs is per dag inclusief een aantal vrije kilometers. Extra kilometers, brandstof en eventuele extra‚Äôs worden achteraf via SnappCar afgerekend.
                    </p>
                </article>
            </div>
        </div>
    </section>
</main>

<!-- FOOTER -->
<footer>
    <div class="container footer-grid">
        <div>
            <div class="footer-logo">KeylessGo</div>
            <p class="footer-text">
                Moderne deelauto's en busjes met keyless toegang. 
                Vlootbeheer door KeylessGo, boekingen via SnappCar.
            </p>
        </div>
        <div class="footer-col">
            <h4>Menu</h4>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="zoek-en-boek.html">Zoek &amp; Boek</a></li>
                <li><a href="index.html#onze-vloot">Onze vloot</a></li>
                <li><a href="index.html#hoe-werkt-huren">Hoe het werkt</a></li>
                <li><a href="index.html#waarom-keylessgo">Waarom KeylessGo</a></li>
            </ul>
        </div>
        <div class="footer-col">
            <h4>Contact</h4>
            <ul>
                <li><a href="contact.html">Contactformulier</a></li>
                <li><a href="mailto:info@keylessgo.nl">info@keylessgo.nl</a></li>
                <li><a href="#">Privacy &amp; cookies</a></li>
            </ul>
        </div>
    </div>
    <div class="copyright">
        ¬© <span id="year"></span> KeylessGo. Boekingen, verificatie en verzekering verlopen via SnappCar.
    </div>
</footer>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Eigen JS -->
<script src="data/map.js"></script>
<script src="data/fleet.js"></script>
<script src="data/find-vehicle.js"></script>

<script>
    // jaar in footer
    document.getElementById("year").textContent = new Date().getFullYear();

    // hamburger menu
    const hamburger = document.getElementById("hamburger");
    const navMenu = document.querySelector(".nav-menu");

    if (hamburger && navMenu) {
        hamburger.addEventListener("click", () => {
            const isActive = navMenu.classList.toggle("active");
            hamburger.setAttribute("aria-expanded", isActive ? "true" : "false");
        });
    }

    // mobile submenu toggle
    const submenuParents = document.querySelectorAll(".has-submenu");
    submenuParents.forEach(parent => {
        parent.addEventListener("click", (e) => {
            if (window.innerWidth > 768) return;
            e.stopPropagation();
            parent.classList.toggle("open");
        });
    });

    // Meer filters toggle
    const advBtn = document.getElementById("toggle-advanced-filters");
    const advPanel = document.getElementById("advanced-filters");
    if (advBtn && advPanel) {
        advBtn.addEventListener("click", () => {
            const visible = advPanel.style.display === "block";
            advPanel.style.display = visible ? "none" : "block";
            advBtn.textContent = visible ? "Meer filters" : "Minder filters";
        });
    }

    // ====== UX/SEO upgrade voor resultaatkaarten: type-labels + usage-tekst ======
    function getSeoLabel(raw) {
        const t = (raw || "").toLowerCase();
        switch (t) {
            case "bus-small":
            case "bus_s":
                return "Bus S";
            case "bus-medium":
            case "bus_m":
                return "Bus M";
            case "bus-large":
            case "bus_l":
                return "Bus L";
            case "auto":
            case "compact":
                return "Compact car";
            case "ev":
            case "elektrisch":
            case "electric":
                return "EV";
            default:
                return raw || "";
        }
    }

    function getUsageText(raw) {
        const t = (raw || "").toLowerCase();

        let base;
        if (t.includes("bus-large") || t === "bus_l") {
            base = "Vaak geboekt voor grote verhuizingen en volumetransport.";
        } else if (t.includes("bus-medium") || t === "bus_m") {
            base = "Populair voor verhuisklussen en grotere transporten.";
        } else if (t.includes("bus-small") || t === "bus_s") {
            base = "Ideaal voor kleine verhuizingen, klussen en bezorgen.";
        } else if (t === "ev" || t.includes("electric") || t.includes("elektrisch")) {
            base = "Elektrische deelauto, perfect voor stille ritten en woon-werkverkeer.";
        } else if (t === "auto" || t === "compact") {
            base = "Compacte stadsauto, veel gebruikt voor korte ritten en dagjes weg.";
        } else {
            base = "Veel gebruikt voor dagelijkse ritten en lichte transportklussen.";
        }

        if (t.includes("bus") || t === "auto" || t === "compact") {
            base += " Geschikt voor binnenstad en milieuzones (Euro 6).";
        }
        if (t === "ev" || t.includes("electric") || t.includes("elektrisch")) {
            base += " Altijd toegestaan in milieuzones en emissievrije zones.";
        }

        return base;
    }

    function enhanceLocationCards(root) {
        if (!root) return;
        const cards = root.querySelectorAll(".location-card");
        cards.forEach(card => {
            const badge = card.querySelector(".location-card-type");
            if (!badge || badge.dataset.enhanced === "1") return;

            const rawText = (badge.textContent || "").trim();
            const seoLabel = getSeoLabel(rawText);
            badge.textContent = seoLabel;
            badge.dataset.enhanced = "1";

            let usageEl = card.querySelector(".location-card-usage");
            if (!usageEl) {
                usageEl = document.createElement("div");
                usageEl.className = "location-card-usage";
                const body = card.querySelector(".location-card-body") || card;
                body.appendChild(usageEl);
            }
            usageEl.textContent = getUsageText(rawText);
        });
    }

    const listEl = document.querySelector("[data-location-list]");
    if (listEl) {
        enhanceLocationCards(listEl);

        const observer = new MutationObserver(() => {
            enhanceLocationCards(listEl);
        });
        observer.observe(listEl, { childList: true, subtree: true });
    }
</script>

</body>
</html>
